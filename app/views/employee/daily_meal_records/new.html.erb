<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Meals - arieoMeals</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <%= stylesheet_link_tag "UserMeal" %>
    <%= javascript_importmap_tags %>
</head>
<body>

    <div class="container">
        <%= render 'shared/employee/sidebar' %>
    </div>

    <div class="main-content">
        <h2>Select your availability</h2>
        <p style="color: blue;">Welcome, <%= current_user.name %>!</p>
        <p class="notice" style="color: green;"><%= notice %></p>
        <p class="alert" style="color: red;"><%= alert %></p>

        <%= form_with model: @daily_meal_record, url: employee_daily_meal_records_path, method: :post, local: true do |f| %>
            <div class="meal-container">
                <div class="meal-selection">
                    <div class="meal-item">
                        <%= f.label :snack, "Snack" %>
                        <%= f.select :snack, options_for_select([["Select", nil], ["Yes", true], ["No", false]], @daily_meal_record.snack), {}, { class: "form-control" } %>
                    </div>
                    <div class="meal-item">
                        <%= f.label :dinner, "Dinner" %>
                        <%= f.select :dinner, options_for_select([["Select", nil], ["Yes", true], ["No", false]], @daily_meal_record.dinner), {}, { id: "dinner-selection", class: "form-control" } %>
                    </div>

                    <!-- Chapati Count - Initially Hidden -->
                    <div class="meal-item-chapati-count" id="chapati-container" >
                        <%= f.label :chapati_count, "Number of Chapatis" %>
                        <%= f.select :chapati_count, options_for_select([["Select",nil], [1, 1], [2, 2], [3, 3], [4, 4], [5, 5], [6, 6]], @daily_meal_record.chapati_count), {}, { id: "chapati-count", class: "form-control", disabled: true } %>
                    </div>
                </div>

                <!-- Submit Button Inside Meal Container -->
                <div class="submit-btn-wrapper">
                    <%= f.submit "Submit", class: "submit-btn" %>
                </div>
            </div>
        <% end %>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const dinnerSelection = document.getElementById("dinner-selection");
            const chapatiContainer = document.getElementById("chapati-container");
            const chapatiSelect = document.getElementById("chapati-count");
    
            function toggleChapatiField() {
                if (dinnerSelection.value === "true") {
                    chapatiContainer.classList.add("active"); // Apply CSS class
                    chapatiSelect.removeAttribute("disabled"); // Enable selection
                } else {
                    chapatiContainer.classList.remove("active"); // Hide again
                    chapatiSelect.setAttribute("disabled", "true"); // Disable selection
                }
            }
    
            if (dinnerSelection) {
                toggleChapatiField();
                dinnerSelection.addEventListener("change", toggleChapatiField);
            }
        });
    </script>
</body>
</html>
